\section{Design and Implementation}
\label{sec:implementation}

\architectureoverview{}

Full details of a single process implementation of the \cb architecture
are available in~\cite{mcdaniel2012cloudbrowser}.  We highlight only the
essential design here.  Figure \ref{fig:cb1arch} shows the relationship 
between the client engine running in the user's browser and the virtual browser
running server side.  When the user visits the application, the client engine
code is downloaded and restores the current view of the application by
copying the current state of the server document.  Subsequently, user input 
is captured, forwarded to the server engine inside the virtual browser, 
which then dispatches it to the document.  All application logic runs
in the global scope associated with the virtual browser's window object.
Since the server environment faithfully mimics a real browser, libraries
such as AngularJS can be used unchanged to implement the user interface.
Client and server communicate through a lightweight RPC protocol that is 
layered on top of a bidirectional web socket communication. 
Stylesheets, images, etc. are provided to the client through a resource
proxy.

\subsection{Application Instances}

% As shown in Figure~\ref{fig:cb2arch}, 

\newarchitectureoverview{}

\requestdispatchdiagram{}

\appinstancefig{}


